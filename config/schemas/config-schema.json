{
  "$defs": {
    "CalibrationSettings": {
      "properties": {
        "sound_duration": {
          "description": "The duration of the calibration sounds.",
          "title": "Sound Duration",
          "type": "number"
        },
        "min_amp": {
          "description": "The minimum amplitude value.",
          "maximum": 0,
          "title": "Min Amp",
          "type": "number"
        },
        "max_amp": {
          "description": "The maximum amplitude value.",
          "maximum": 0,
          "title": "Max Amp",
          "type": "number"
        },
        "amp_steps": {
          "description": "The number of amplitude values to use in the calibration.",
          "exclusiveMinimum": 0,
          "title": "Amp Steps",
          "type": "integer"
        }
      },
      "required": [
        "sound_duration",
        "min_amp",
        "max_amp",
        "amp_steps"
      ],
      "title": "CalibrationSettings",
      "type": "object"
    },
    "ComputerSoundCard": {
      "properties": {
        "soundcard_name": {
          "description": "The name of the soundcard being used in the calibration.",
          "title": "Soundcard Name",
          "type": "string"
        },
        "fs": {
          "description": "The sampling frequency of the soundcard (Hz).",
          "exclusiveMinimum": 0,
          "title": "Fs",
          "type": "integer"
        },
        "speaker": {
          "description": "Indicates which speaker will be calibrated.",
          "enum": [
            "Left",
            "Right"
          ],
          "title": "Speaker",
          "type": "string"
        }
      },
      "required": [
        "soundcard_name",
        "fs",
        "speaker"
      ],
      "title": "ComputerSoundCard",
      "type": "object"
    },
    "EQFilter": {
      "properties": {
        "sound_duration": {
          "description": "The duration of the sound used to determine the EQ filter.",
          "exclusiveMinimum": 0,
          "title": "Sound Duration",
          "type": "number"
        },
        "time_constant": {
          "default": 0.005,
          "description": "The duration of each division of the original signal that is used to compute the EQ filter (s).",
          "exclusiveMinimum": 0,
          "title": "Time Constant",
          "type": "number"
        },
        "amplitude": {
          "default": 1,
          "description": "The amplitude of the speakers.",
          "maximum": 1,
          "minimum": 0,
          "title": "Amplitude",
          "type": "number"
        }
      },
      "required": [
        "sound_duration"
      ],
      "title": "EQFilter",
      "type": "object"
    },
    "Filter": {
      "properties": {
        "filter_input": {
          "default": true,
          "description": "Indicates whether the band-pass filter is applied to the input sound.",
          "title": "Filter Input",
          "type": "boolean"
        },
        "filter_acquisition": {
          "default": true,
          "description": "Indicates whether the band-pass filter is applied to the acquired sound.",
          "title": "Filter Acquisition",
          "type": "boolean"
        },
        "min_freq": {
          "description": "The low cuttoff frequency of the filter (Hz).",
          "maximum": 80000,
          "minimum": 0,
          "title": "Min Freq",
          "type": "number"
        },
        "max_freq": {
          "description": "The high cuttoff frequency of the filter (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 80000,
          "title": "Max Freq",
          "type": "number"
        }
      },
      "required": [
        "min_freq",
        "max_freq"
      ],
      "title": "Filter",
      "type": "object"
    },
    "HarpSoundCard": {
      "properties": {
        "serial_port": {
          "description": "The serial port of the soundcard used for the calibration. The string should be of the format \"COM?\" in Windows and \"/dev/ttyUSB?\" in Linux, in which \"?\" is the serial port number.",
          "pattern": "^((COM\\d+)|(/dev/ttyUSB\\d+))$",
          "title": "Serial Port",
          "type": "string"
        },
        "fs": {
          "description": "The sampling frequency of the soundcard (Hz).",
          "enum": [
            96000,
            192000
          ],
          "title": "Fs",
          "type": "integer"
        },
        "speaker": {
          "description": "Indicates which speaker will be calibrated.",
          "enum": [
            "Left",
            "Right"
          ],
          "title": "Speaker",
          "type": "string"
        },
        "soundcard_id": {
          "anyOf": [
            {
              "pattern": "^V\\d.\\d X\\d{4}$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The ID of the soundcard. If the soundcard is a Harp device, the ID should be of the format \"V?.? X????\", in which \"?\" are numbers.",
          "title": "Soundcard Id"
        },
        "audio_amp_id": {
          "anyOf": [
            {
              "pattern": "^V\\d.\\d X\\d{4}$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The ID of the audio amplifier. If the audio amplifier is a Harp device, the ID should be of the format \"V?.? X????\", in which \"?\" are numbers.",
          "title": "Audio Amp Id"
        }
      },
      "required": [
        "serial_port",
        "fs",
        "speaker"
      ],
      "title": "HarpSoundCard",
      "type": "object"
    },
    "Moku": {
      "properties": {
        "fs": {
          "description": "The sampling frequency of the ADC (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 500000,
          "title": "Fs",
          "type": "integer"
        },
        "address": {
          "pattern": "^(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$|^::(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}$|^[0-9a-fA-F]{1,4}::(?:[0-9a-fA-F]{1,4}:){0,5}[0-9a-fA-F]{1,4}$|^[0-9a-fA-F]{1,4}:[0-9a-fA-F]{1,4}::(?:[0-9a-fA-F]{1,4}:){0,4}[0-9a-fA-F]{1,4}$|^(?:[0-9a-fA-F]{1,4}:){0,2}[0-9a-fA-F]{1,4}::(?:[0-9a-fA-F]{1,4}:){0,3}[0-9a-fA-F]{1,4}$|^(?:[0-9a-fA-F]{1,4}:){0,3}[0-9a-fA-F]{1,4}::(?:[0-9a-fA-F]{1,4}:){0,2}[0-9a-fA-F]{1,4}$|^(?:[0-9a-fA-F]{1,4}:){0,4}[0-9a-fA-F]{1,4}::(?:[0-9a-fA-F]{1,4}:)?[0-9a-fA-F]{1,4}$|^(?:[0-9a-fA-F]{1,4}:){0,5}[0-9a-fA-F]{1,4}::[0-9a-fA-F]{1,4}$|^(?:[0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}::$",
          "title": "Address",
          "type": "string"
        },
        "channel": {
          "description": "The Moku channel used in the recordings.",
          "maximum": 2,
          "minimum": 1,
          "title": "Channel",
          "type": "integer"
        }
      },
      "required": [
        "fs",
        "address",
        "channel"
      ],
      "title": "Moku",
      "type": "object"
    },
    "NiDaq": {
      "properties": {
        "fs": {
          "description": "The sampling frequency of the ADC (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 250000,
          "title": "Fs",
          "type": "integer"
        },
        "device_id": {
          "description": "The NI-DAQ ID number.",
          "minimum": 1,
          "title": "Device Id",
          "type": "integer"
        },
        "channel": {
          "description": "The analog input pin of the NI-DAQ being used.",
          "exclusiveMinimum": 0,
          "maximum": 7,
          "title": "Channel",
          "type": "integer"
        }
      },
      "required": [
        "fs",
        "device_id",
        "channel"
      ],
      "title": "NiDaq",
      "type": "object"
    },
    "NoiseProtocol": {
      "properties": {
        "min_freq": {
          "description": "The minimum frequency of the noise spectrum (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 80000,
          "title": "Min Freq",
          "type": "number"
        },
        "max_freq": {
          "description": "The maximum frequency of the noise spectrum (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 80000,
          "title": "Max Freq",
          "type": "number"
        },
        "mic_factor": {
          "description": "The conversion factor of the microphone (V/Pa).",
          "exclusiveMinimum": 0,
          "title": "Mic Factor",
          "type": "number"
        },
        "reference_pressure": {
          "description": "The reference pressure (Pa).",
          "exclusiveMinimum": 0,
          "title": "Reference Pressure",
          "type": "number"
        },
        "ramp_time": {
          "default": 0.005,
          "description": "The ramp time of the sounds used during the calibration process (s).",
          "minimum": 0,
          "title": "Ramp Time",
          "type": "number"
        },
        "eq_filter": {
          "$ref": "#/$defs/EQFilter",
          "description": "The settings related to the EQ filter calculation. Noise calibration only!"
        },
        "calibration": {
          "$ref": "#/$defs/CalibrationSettings",
          "description": "The settings used for the actual speaker calibration."
        },
        "test_calibration": {
          "anyOf": [
            {
              "$ref": "#/$defs/TestSettings"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The settings used for the calibration test."
        }
      },
      "required": [
        "min_freq",
        "max_freq",
        "mic_factor",
        "reference_pressure",
        "eq_filter",
        "calibration"
      ],
      "title": "NoiseProtocol",
      "type": "object"
    },
    "Paths": {
      "properties": {
        "output": {
          "description": "The path to the output directory, where the output date will be saved.",
          "title": "Output",
          "type": "string"
        },
        "eq_filter": {
          "anyOf": [
            {
              "pattern": "\\.npy$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The path to the EQ filter to be used in the calibration.",
          "title": "Eq Filter"
        },
        "calibration": {
          "anyOf": [
            {
              "pattern": "\\.npy$",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The calibration parameters to be used to test the calibration.",
          "title": "Calibration"
        }
      },
      "required": [
        "output"
      ],
      "title": "Paths",
      "type": "object"
    },
    "PureToneCalibrationSettings": {
      "properties": {
        "sound_duration": {
          "description": "The duration of the calibration sounds.",
          "title": "Sound Duration",
          "type": "number"
        },
        "min_amp": {
          "description": "The minimum amplitude value.",
          "maximum": 0,
          "title": "Min Amp",
          "type": "number"
        },
        "max_amp": {
          "description": "The maximum amplitude value.",
          "maximum": 0,
          "title": "Max Amp",
          "type": "number"
        },
        "amp_steps": {
          "description": "The number of amplitude values to use in the calibration.",
          "exclusiveMinimum": 0,
          "title": "Amp Steps",
          "type": "integer"
        },
        "min_freq": {
          "description": "The minimum frequency to use in the pure tone calibration protocol (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 80000,
          "title": "Min Freq",
          "type": "number"
        },
        "max_freq": {
          "description": "The maximum frequency to use in the pure tone calibration protocol (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 80000,
          "title": "Max Freq",
          "type": "number"
        },
        "freq_steps": {
          "description": "The number of pure tones to use in the calibration.",
          "exclusiveMinimum": 0,
          "title": "Freq Steps",
          "type": "integer"
        }
      },
      "required": [
        "sound_duration",
        "min_amp",
        "max_amp",
        "amp_steps",
        "min_freq",
        "max_freq",
        "freq_steps"
      ],
      "title": "PureToneCalibrationSettings",
      "type": "object"
    },
    "PureToneProtocol": {
      "properties": {
        "mic_factor": {
          "description": "The conversion factor of the microphone (V/Pa).",
          "exclusiveMinimum": 0,
          "title": "Mic Factor",
          "type": "number"
        },
        "reference_pressure": {
          "description": "The reference pressure (Pa).",
          "exclusiveMinimum": 0,
          "title": "Reference Pressure",
          "type": "number"
        },
        "ramp_time": {
          "default": 0.005,
          "description": "The ramp time of the sounds used during the calibration process (s).",
          "minimum": 0,
          "title": "Ramp Time",
          "type": "number"
        },
        "calibration": {
          "$ref": "#/$defs/PureToneCalibrationSettings",
          "description": "The settings used for the actual speaker calibration."
        },
        "test_calibration": {
          "anyOf": [
            {
              "$ref": "#/$defs/PureToneTestSettings"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "The settings used for the calibration test."
        }
      },
      "required": [
        "mic_factor",
        "reference_pressure",
        "calibration"
      ],
      "title": "PureToneProtocol",
      "type": "object"
    },
    "PureToneTestSettings": {
      "properties": {
        "sound_duration": {
          "description": "The duration of the test sounds.",
          "exclusiveMinimum": 0,
          "title": "Sound Duration",
          "type": "number"
        },
        "min_db": {
          "description": "The minimum nominal dB SPL value to be tested.",
          "title": "Min Db",
          "type": "number"
        },
        "max_db": {
          "description": "The maximum nominal dB SPL value to be tested.",
          "title": "Max Db",
          "type": "number"
        },
        "db_steps": {
          "description": "The number of dB SPL values to be tested.",
          "exclusiveMinimum": 0,
          "title": "Db Steps",
          "type": "integer"
        },
        "min_freq": {
          "description": "The minimum frequency to use in the pure tone calibration protocol (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 80000,
          "title": "Min Freq",
          "type": "number"
        },
        "max_freq": {
          "description": "The maximum frequency to use in the pure tone calibration protocol (Hz).",
          "exclusiveMinimum": 0,
          "maximum": 80000,
          "title": "Max Freq",
          "type": "number"
        },
        "freq_steps": {
          "description": "The number of pure tones to use in the calibration.",
          "exclusiveMinimum": 0,
          "title": "Freq Steps",
          "type": "integer"
        }
      },
      "required": [
        "sound_duration",
        "min_db",
        "max_db",
        "db_steps",
        "min_freq",
        "max_freq",
        "freq_steps"
      ],
      "title": "PureToneTestSettings",
      "type": "object"
    },
    "TestSettings": {
      "properties": {
        "sound_duration": {
          "description": "The duration of the test sounds.",
          "exclusiveMinimum": 0,
          "title": "Sound Duration",
          "type": "number"
        },
        "min_db": {
          "description": "The minimum nominal dB SPL value to be tested.",
          "title": "Min Db",
          "type": "number"
        },
        "max_db": {
          "description": "The maximum nominal dB SPL value to be tested.",
          "title": "Max Db",
          "type": "number"
        },
        "db_steps": {
          "description": "The number of dB SPL values to be tested.",
          "exclusiveMinimum": 0,
          "title": "Db Steps",
          "type": "integer"
        }
      },
      "required": [
        "sound_duration",
        "min_db",
        "max_db",
        "db_steps"
      ],
      "title": "TestSettings",
      "type": "object"
    }
  },
  "properties": {
    "soundcard": {
      "anyOf": [
        {
          "$ref": "#/$defs/HarpSoundCard"
        },
        {
          "$ref": "#/$defs/ComputerSoundCard"
        }
      ],
      "description": "The soundcard details.",
      "title": "Soundcard"
    },
    "adc": {
      "anyOf": [
        {
          "$ref": "#/$defs/NiDaq"
        },
        {
          "$ref": "#/$defs/Moku"
        }
      ],
      "description": "The ADC details.",
      "title": "Adc"
    },
    "filter": {
      "$ref": "#/$defs/Filter",
      "default": {
        "filter_input": true,
        "filter_acquisition": true,
        "min_freq": 5000.0,
        "max_freq": 20000.0
      },
      "description": "The configuration parameters of the band-pass filter used."
    },
    "protocol": {
      "anyOf": [
        {
          "$ref": "#/$defs/NoiseProtocol"
        },
        {
          "$ref": "#/$defs/PureToneProtocol"
        }
      ],
      "title": "Protocol"
    },
    "paths": {
      "$ref": "#/$defs/Paths",
      "description": "Contains paths to files that will be used in the calibration protocol."
    }
  },
  "required": [
    "soundcard",
    "adc",
    "protocol",
    "paths"
  ],
  "title": "Settings",
  "type": "object"
}